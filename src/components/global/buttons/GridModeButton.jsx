import useBoardStore from "../../../stores/useBoardStore";
import useConfigStore from "../../../stores/useConfigStore";
import useToggleOnKeyPress from "../../../hooks/useToggleOnKeyPress";
import ToolTip from "../ToolTip";

const GridModeButton = () => {
	let keyboardShortcut = useConfigStore(
		(state) => state?.dd_config?.dd_frontend?.keyboardShortcuts?.gridMode
	) || ["âŒ˜", "G"];

	const gridMode = useBoardStore((state) => state.gridMode);
	const setGridMode = useBoardStore((state) => state.setGridMode);

	// region Icons

	// HEROICONS MODIFIED squares-2x2_crossed (solid)
	let noGridIcon = (
		<svg
			xmlns="http://www.w3.org/2000/svg"
			viewBox="0 0 1000 1000"
			fill="currentColor"
			className="w-5 h-5 mr-0 inline align-middle"
		>
			<path
				fill="currentColor"
				fillRule="evenodd"
				stroke="none"
				d="M 119.792892 880.207092 C 101.291351 861.705566 101.291351 831.708618 119.792892 813.207092 L 812.5 120.5 C 831.001587 101.998413 860.998413 101.998474 879.5 120.5 C 898.001526 139.001587 898.001587 168.998413 879.5 187.5 L 186.792892 880.207092 C 168.291351 898.708618 138.294434 898.708618 119.792892 880.207092 Z M 284 875 L 468.75 690.25 L 468.75 750 C 468.75 819.035645 412.785614 875 343.75 875 L 284 875 Z M 535.615479 623.384521 L 623.384521 535.615479 C 633.856995 532.769043 644.876099 531.25 656.25 531.25 L 750 531.25 C 819.035583 531.25 875 587.214355 875 656.25 L 875 750 C 875 819.035645 819.035583 875 750 875 L 656.25 875 C 587.214417 875 531.25 819.035645 531.25 750 L 531.25 656.25 C 531.25 644.876099 532.769104 633.857056 535.615479 623.384521 Z M 125 656.25 L 125 716 L 309.75 531.25 L 250 531.25 C 180.964417 531.25 125 587.214355 125 656.25 Z M 464.384552 376.615479 L 376.615448 464.384521 C 366.142975 467.230896 355.123901 468.75 343.75 468.75 L 250 468.75 C 180.964417 468.75 125 412.785583 125 343.75 L 125 250 C 125 180.964417 180.964417 125 250 125 L 343.75 125 C 412.785614 125 468.75 180.964417 468.75 250 L 468.75 343.75 C 468.75 355.123901 467.230927 366.143005 464.384552 376.615479 Z M 690.25 468.75 L 875 284 L 875 343.75 C 875 412.785583 819.035583 468.75 750 468.75 L 690.25 468.75 Z M 716 125 L 531.25 309.75 L 531.25 250 C 531.25 180.964417 587.214417 125 656.25 125 L 716 125 Z"
			/>
		</svg>
	);

	// HEROICONS squares-2x2 (solid)
	let gridIcon = (
		<svg
			xmlns="http://www.w3.org/2000/svg"
			viewBox="0 0 24 24"
			fill="currentColor"
			className="w-5 h-5 mr-0 inline align-middle"
		>
			<path
				fillRule="evenodd"
				d="M3 6a3 3 0 0 1 3-3h2.25a3 3 0 0 1 3 3v2.25a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3V6Zm9.75 0a3 3 0 0 1 3-3H18a3 3 0 0 1 3 3v2.25a3 3 0 0 1-3 3h-2.25a3 3 0 0 1-3-3V6ZM3 15.75a3 3 0 0 1 3-3h2.25a3 3 0 0 1 3 3V18a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3v-2.25Zm9.75 0a3 3 0 0 1 3-3H18a3 3 0 0 1 3 3V18a3 3 0 0 1-3 3h-2.25a3 3 0 0 1-3-3v-2.25Z"
				clipRule="evenodd"
			/>
		</svg>
	);

	// HEROICONS MODIFIED squares-2x2_info_4
	let infoIcon = (
		<svg
			xmlns="http://www.w3.org/2000/svg"
			viewBox="0 0 1000 1000"
			fill="currentColor"
			className="w-5 h-5 mr-0 inline align-middle"
		>
			<path
				fill="currentColor"
				fillRule="evenodd"
				stroke="none"
				d="M 125 656.25 C 125 587.214355 180.964417 531.25 250 531.25 L 343.75 531.25 C 412.785614 531.25 468.75 587.214355 468.75 656.25 L 468.75 750 C 468.75 819.035645 412.785614 875 343.75 875 L 250 875 C 180.964417 875 125 819.035645 125 750 L 125 656.25 Z M 531.25 656.25 C 531.25 587.214355 587.214417 531.25 656.25 531.25 L 750 531.25 C 819.035583 531.25 875 587.214355 875 656.25 L 875 750 C 875 819.035645 819.035583 875 750 875 L 656.25 875 C 587.214417 875 531.25 819.035645 531.25 750 L 531.25 656.25 Z M 341.439178 698.080383 C 350.67691 704.435181 357.579773 711.789185 362.147858 720.142578 C 366.715942 728.496033 369 737.848633 369 748.200806 C 369 759.372864 365.980011 769.699219 359.939941 779.180115 C 353.899902 788.661011 345.14447 795.835693 333.673431 800.704224 C 322.202362 805.572815 307.178589 808.00708 288.601593 808.00708 C 264.441315 808.00708 246.27066 804.214722 234.08902 796.630005 C 227.287598 792.325195 223.886932 787.200439 223.886932 781.255676 C 223.886932 776.74585 225.384247 772.927917 228.378891 769.801758 C 231.373535 766.675659 235.002609 765.11261 239.26619 765.11261 C 242.210083 765.11261 245.255447 766.137512 248.402374 768.187439 C 252.868958 771.262329 257.081726 773.312256 261.040741 774.337219 C 267.131592 775.772156 275.506348 776.489624 286.165253 776.489624 C 304.336212 776.489624 317.482025 774.106628 325.603119 769.340515 C 333.724243 764.574463 337.784698 757.835449 337.784698 749.123291 C 337.784698 742.666016 335.42453 736.439453 330.704163 730.44342 C 325.983795 724.447388 319.664642 719.809509 311.746582 716.529663 C 307.178497 714.684692 299.463562 713.403503 288.601593 712.686035 C 283.424347 712.37854 279.440033 710.764282 276.648407 707.84314 C 273.856781 704.921997 272.460999 701.309021 272.460999 697.00415 C 272.460999 692.494385 273.983673 688.702026 277.029083 685.627197 C 280.074463 682.552246 283.931946 681.014893 288.601593 681.014893 C 298.955963 681.014893 304.488342 680.963623 305.198975 680.861084 C 309.259521 680.451111 313.320007 679.118652 317.380554 676.86377 C 321.441101 674.608887 324.714874 671.508423 327.201965 667.562256 C 329.689056 663.616211 330.932556 659.541992 330.932556 655.339661 C 330.932556 648.677429 328.014069 642.912109 322.177063 638.043518 C 316.340027 633.174927 307.584564 630.740723 295.910522 630.740723 C 280.886505 630.740723 269.415649 635.147949 261.497559 643.962646 C 259.16275 646.525024 257.28479 648.164978 255.863586 648.882446 C 253.731812 650.009888 251.346268 650.573608 248.706909 650.573608 C 244.443329 650.573608 240.78891 649.036255 237.743484 645.961304 C 234.698074 642.886414 233.1754 639.094116 233.1754 634.58429 C 233.1754 627.512085 237.844955 620.644897 247.184204 613.982666 C 260.787048 604.245483 277.790344 599.377014 298.19458 599.377014 C 317.482208 599.377014 332.962799 604.911743 344.636841 615.981323 C 356.310883 627.050903 362.147858 640.375244 362.147858 655.954651 C 362.147858 664.05188 360.42218 671.61084 356.970703 678.631836 C 353.519226 685.652832 348.342133 692.13562 341.439178 698.080383 Z M 746.681946 725.329407 L 746.681946 594.425537 L 701.192261 594.425537 L 618.773682 730.878967 L 618.773682 758.789917 L 712.270935 758.789917 L 712.270935 772.174072 L 698.842224 772.174072 C 690.561157 772.174072 684.658203 773.72467 681.133179 776.825928 C 677.608154 779.927124 675.845642 783.926025 675.845642 788.822693 C 675.845642 793.828186 677.608154 797.881531 681.133179 800.982727 C 684.658203 804.083984 690.561157 805.634521 698.842224 805.634521 L 745.003357 805.634521 C 753.284485 805.634521 759.187439 804.083984 762.712463 800.982727 C 766.237488 797.881531 768 793.882629 768 788.985962 C 768 784.089233 766.265503 780.063171 762.796387 776.907532 C 759.327271 773.751892 753.955872 772.174072 746.681946 772.174072 L 746.681946 758.789917 C 753.843933 758.789917 759.187439 757.212097 762.712463 754.056458 C 766.237488 750.900818 768 746.874756 768 741.978027 C 768 737.08136 766.265503 733.082458 762.796387 729.981201 C 759.327271 726.880005 753.955872 725.329407 746.681946 725.329407 Z M 712.270935 643.065613 L 712.270935 725.329407 L 662.416931 725.329407 L 712.270935 643.065613 Z M 125 250 C 125 180.964417 180.964417 125 250 125 L 343.75 125 C 412.785614 125 468.75 180.964417 468.75 250 L 468.75 343.75 C 468.75 412.785583 412.785614 468.75 343.75 468.75 L 250 468.75 C 180.964417 468.75 125 412.785583 125 343.75 L 125 250 Z M 531.25 250 C 531.25 180.964417 587.214417 125 656.25 125 L 750 125 C 819.035583 125 875 180.964417 875 250 L 875 343.75 C 875 412.785583 819.035583 468.75 750 468.75 L 656.25 468.75 C 587.214417 468.75 531.25 412.785583 531.25 343.75 L 531.25 250 Z M 313.435608 189.036743 L 313.435608 370.267151 L 346.871155 370.267151 C 354.839752 370.267151 360.519958 371.801636 363.911987 374.870605 C 367.303986 377.939575 369 381.950684 369 386.904175 C 369 391.749939 367.303986 395.707214 363.911987 398.776184 C 360.519958 401.845215 354.839752 403.379639 346.871155 403.379639 L 246.887527 403.379639 C 238.918945 403.379639 233.238739 401.845215 229.846695 398.776184 C 226.454666 395.707214 224.758682 391.696106 224.758682 386.742615 C 224.758682 381.896851 226.454666 377.939575 229.846695 374.870605 C 233.238739 371.801636 238.918945 370.267151 246.887527 370.267151 L 280.32309 370.267151 L 280.32309 232.163757 L 250.764114 239.916931 C 246.026047 241.209106 242.472534 241.855225 240.1035 241.855225 C 235.903839 241.855225 232.269592 240.186157 229.200592 236.847961 C 226.131607 233.509766 224.597153 229.417847 224.597153 224.572083 C 224.597153 220.157104 225.727829 216.684326 227.989166 214.153748 C 230.250504 211.623169 234.988525 209.388794 242.203323 207.4505 L 313.435608 189.036743 Z M 750.659546 367.0896 L 679.288147 367.0896 C 711.821411 339.431091 733.704163 320.250549 744.937073 309.547485 C 759.243286 295.983154 768.277161 285.35968 772.039124 277.676758 C 775.801147 269.993835 777.682068 261.648682 777.682068 252.641113 C 777.682068 234.943909 771.112 219.86969 757.971497 207.418091 C 744.831055 194.966431 727.981873 188.740723 707.423401 188.740723 C 694.177002 188.740723 681.911011 191.601929 670.625061 197.324341 C 659.339111 203.046753 650.755554 210.676636 644.874146 220.21405 C 638.992737 229.751465 636.052063 237.699219 636.052063 244.057495 C 636.052063 248.296326 637.668091 252.005249 640.900208 255.184448 C 644.132385 258.363586 647.973755 259.953125 652.424561 259.953125 C 656.239502 259.953125 659.445129 258.99939 662.041443 257.091919 C 664.637695 255.184448 666.677612 252.00531 668.161255 247.554504 C 670.598572 240.454468 673.830627 235.102966 677.857544 231.499939 C 685.593445 224.717773 695.289673 221.326721 706.946533 221.326721 C 718.497437 221.326721 727.743286 224.373352 734.684448 230.466736 C 741.625549 236.56012 745.096069 243.580566 745.096069 251.528442 C 745.096069 257.886719 742.022949 264.615784 735.876587 271.715881 C 723.689941 285.598145 688.242981 316.753235 629.534851 365.182129 L 629.534851 399.675659 L 778 399.675659 L 778 384.097961 C 778 376.150085 776.542908 370.533691 773.628723 367.248596 C 770.714478 363.96344 766.76709 362.320923 761.786438 362.320923 C 758.289429 362.320923 754.580505 363.910522 750.659546 367.0896 Z"
			/>
		</svg>
	);

	let gridModeButtonOnClick = (e) => {
		if (gridMode === null) setGridMode("grid");
		if (gridMode === "grid") setGridMode("grid-labelled");
		if (gridMode === "grid-labelled") setGridMode(null);
	};

	useToggleOnKeyPress(keyboardShortcut, gridModeButtonOnClick);

	let gridModeBasedValue = (valueFalse, valueGrid, valueInfo) => {
		return gridMode
			? gridMode === "grid"
				? valueGrid
				: valueInfo
			: valueFalse;
	};

	// region Rendering

	return (
		<button
			className={`relative h-24 w-12 px-4 py-2 rounded-md text-white transition duration-300 shadow-md ${
				gridMode ? "bg-gray-800/70" : "bg-gray-800/70"
			}`}
			onClick={gridModeButtonOnClick}
		>
			<span
				className={`absolute bottom-0.5 left-0.5 m-0.5 w-10 h-10 rounded-md 
						  shadow-md transform transition-transform duration-200 
						  ${gridModeBasedValue(
								"translate-y-0 bg-gray-500/25",
								"-translate-y-6 bg-gray-500/50",
								"-translate-y-12 bg-gray-500/50"
							)}`}
			>
				<span
					className={`flex text-center items-center justify-center h-full
						${gridModeBasedValue("text-white/30", "text-white", "text-white")}`}
				>
					{gridModeBasedValue(noGridIcon, gridIcon, infoIcon)}
				</span>
			</span>
			<ToolTip keys={keyboardShortcut} />
		</button>
	);
};

export default GridModeButton;
